<?xml version="1.0"?>
<template title="Example" lang="fr" version="2.0">
  <infos>
    <info name="authors">Brice Texier</info>
  </infos>
  <parameters>
    <parameter name="started_on" nature="date"/>
    <parameter name="stopped_on" nature="date"/>
  </parameters>
  <document unit="mm" size="10">
    <page orientation="portrait" format="A4" margin="10mm">
      <part height="30mm">
        <set>
          <image value="{{company.entity/photo}}" height="30mm">
            <text value="{{company.entity/full_name}}" size="16"/>
          </image>
        </set>
      </part>
      <part height="14mm">
        <set>
          <text value="Grand livre" left="50%" align="center" width="150mm" bold="true" size="12"/>
          <text value="Du {{started_on?format=month_letter}} au {{stopped_on?format=month_letter}}" left="50%" align="center" width="150mm" top="7mm" size="12"/>
        </set>
      </part>
      
      <!-- Array of entries of the journal for the matching period -->
      <iteration variable="account" collection="company.accounts">

        <part height="6mm">
          <set top="2mm">
            <text value="{{account/number}} : {{account/name}}" width="150mm" bold="true"/>
          </set>
        </part>
        <table collection="account.journal_entry_lines_between(started_on, stopped_on)" fixed="true" if="account.journal_entry_lines_between(started_on, stopped_on).size &gt; 0">
          <column label="Date" property="entry/printed_on" width="20mm"/>
          <column label="Number" property="entry/number" width="30mm" align="left"/>
          <column label="Label of journal entry" property="name" width="100mm"/>
          <column label="Debit" property="debit" width="20mm" numeric="money"/>
          <column label="Credit" property="credit" width="20mm" numeric="money"/>
        </table>
        
        <!-- Sum -->
        <part height="10mm" if="account.journal_entry_lines_between(started_on, stopped_on).size &gt; 0">
          <set left="130mm">
            <text value="Totaux" top="0.5mm" left="19mm" align="right" bold="true"/>
            <text value="{{account.journal_entry_lines_calculate(:debit, started_on, stopped_on)?numeric}}" top="0.5mm" left="39.5mm" align="right" bold="true"/>
            <text value="{{account.journal_entry_lines_calculate(:credit, started_on, stopped_on)?numeric}}" top="0.5mm" left="59.5mm" align="right" bold="true"/>
            <text value="Solde" top="4.5mm" left="19mm" align="right" bold="true"/>
            <text value="{{account.journal_entry_lines_calculate(:balance, started_on, stopped_on)?numeric}}" top="4.5mm" left="40mm" align="center" bold="true"/>
            <rectangle width="60mm" height="4mm" border="0.5 solid #000"/>
            <rectangle width="60mm" height="4mm" border="0.5 solid #000" top="4mm"/>
            <line path="20mm,0 ; 20mm,8mm" border="0.5 solid #000"/>
            <line path="40mm,0 ; 40mm,4mm" border="0.5 solid #000"/>
          </set>
        </part>
      </iteration>
      
    </page>
    
  </document>
</template>
